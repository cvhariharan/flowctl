// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.27.0
// source: execution.sql

package repo

import (
	"context"
	"encoding/json"
)

const addToQueue = `-- name: AddToQueue :one
INSERT INTO execution_queue (
    flow_id,
    input
) VALUES (
    $1, $2
) RETURNING id, uuid, flow_id, input, status, created_at, updated_at
`

type AddToQueueParams struct {
	FlowID int32           `db:"flow_id" json:"flow_id"`
	Input  json.RawMessage `db:"input" json:"input"`
}

func (q *Queries) AddToQueue(ctx context.Context, arg AddToQueueParams) (ExecutionQueue, error) {
	row := q.db.QueryRowContext(ctx, addToQueue, arg.FlowID, arg.Input)
	var i ExecutionQueue
	err := row.Scan(
		&i.ID,
		&i.Uuid,
		&i.FlowID,
		&i.Input,
		&i.Status,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const getFromQueueByID = `-- name: GetFromQueueByID :one
SELECT id, uuid, flow_id, input, status, created_at, updated_at FROM execution_queue WHERE id = $1
`

func (q *Queries) GetFromQueueByID(ctx context.Context, id int32) (ExecutionQueue, error) {
	row := q.db.QueryRowContext(ctx, getFromQueueByID, id)
	var i ExecutionQueue
	err := row.Scan(
		&i.ID,
		&i.Uuid,
		&i.FlowID,
		&i.Input,
		&i.Status,
		&i.CreatedAt,
		&i.UpdatedAt,
	)
	return i, err
}

const updateStatusByID = `-- name: UpdateStatusByID :exec
UPDATE execution_queue SET status = $2 WHERE id = $1
`

type UpdateStatusByIDParams struct {
	ID     int32           `db:"id" json:"id"`
	Status ExecutionStatus `db:"status" json:"status"`
}

func (q *Queries) UpdateStatusByID(ctx context.Context, arg UpdateStatusByIDParams) error {
	_, err := q.db.ExecContext(ctx, updateStatusByID, arg.ID, arg.Status)
	return err
}
