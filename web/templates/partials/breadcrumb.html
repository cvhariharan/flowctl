{{ define "partials/breadcrumb" }}
<!-- Breadcrumb -->
<nav class="flex items-center space-x-2 text-sm" x-data="breadcrumbManager()">
    <template x-if="namespace">
        <div class="flex items-center space-x-2">
            <span class="text-gray-500 font-medium">Namespaces</span>
            <span class="text-gray-400 font-medium">/</span>
            <span class="text-gray-500 font-medium" x-text="namespace"></span>
            <span class="text-gray-400 font-medium">/</span>
        </div>
    </template>
    <span class="text-gray-900 font-medium" x-text="pageTitle"></span>
</nav>

<script>
function breadcrumbManager() {
    return {
        namespace: '',
        pageTitle: '',
        
        init() {
            this.extractBreadcrumbData();
        },
        
        extractBreadcrumbData() {
            const path = window.location.pathname;
            const pathParts = path.split('/').filter(part => part); // Remove empty parts
            
            // Handle different URL patterns
            if (pathParts.length >= 2 && pathParts[0] === 'view') {
                this.namespace = pathParts[1];
                
                // Determine page title based on path
                if (pathParts.length === 2) {
                    this.pageTitle = 'Flows'; // Default view
                } else if (pathParts[2] === 'flows') {
                    if (pathParts.length === 3) {
                        this.pageTitle = 'Flows';
                    } else if (pathParts.length >= 4) {
                        this.pageTitle = 'Run Flow';
                    }
                } else if (pathParts[2] === 'nodes') {
                    this.pageTitle = 'Nodes';
                } else if (pathParts[2] === 'credentials') {
                    this.pageTitle = 'Credentials';
                } else if (pathParts[2] === 'members') {
                    this.pageTitle = 'Members';
                } else if (pathParts[2] === 'approvals') {
                    this.pageTitle = 'Approvals';
                } else if (pathParts[2] === 'history') {
                    this.pageTitle = 'History';
                } else if (pathParts[2] === 'results') {
                    this.pageTitle = 'Execution Status';
                } else {
                    this.pageTitle = pathParts[2].charAt(0).toUpperCase() + pathParts[2].slice(1);
                }
            } else if (pathParts[0] === 'admin' && pathParts[1] === 'settings') {
                this.namespace = '';
                this.pageTitle = 'Settings';
            } else {
                // Default fallback
                this.namespace = '';
                this.pageTitle = 'Dashboard';
            }
            
            console.log('Breadcrumb data:', { namespace: this.namespace, pageTitle: this.pageTitle });
        }
    };
}
</script>
{{ end }}